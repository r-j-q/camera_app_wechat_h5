require('./common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["cognitiveTasksPage/ETBexperiment_new"],{4448:function(e,t,i){"use strict";i.r(t);var n=i("4b99"),s=i("5a98");for(var o in s)"default"!==o&&function(e){i.d(t,e,(function(){return s[e]}))}(o);i("6ffe");var r,a=i("f0c5"),u=Object(a["a"])(s["default"],n["b"],n["c"],!1,null,"518183ec",null,!1,n["a"],r);t["default"]=u.exports},"4b99":function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return n}));var n={uLineProgress:function(){return Promise.all([i.e("common/vendor"),i.e("node-modules/uview-ui/components/u-line-progress/u-line-progress")]).then(i.bind(null,"4cd3"))},uButton:function(){return Promise.all([i.e("common/vendor"),i.e("node-modules/uview-ui/components/u-button/u-button")]).then(i.bind(null,"e8d6"))}},s=function(){var e=this,t=e.$createElement,i=(e._self._c,((e.cumulation+1)/72*100).toFixed(2));e.$mp.data=Object.assign({},{$root:{g0:i}})},o=[]},"5a98":function(e,t,i){"use strict";i.r(t);var n=i("9d26"),s=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);t["default"]=s.a},"6ffe":function(e,t,i){"use strict";var n=i("7892"),s=i.n(n);s.a},7892:function(e,t,i){},"818d":function(e,t,i){"use strict";(function(e){i("9263");n(i("66fd"));var t=n(i("4448"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=i,e(t.default)}).call(this,i("543d")["createPage"])},"9d26":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(i("a34a")),s=i("6df0"),o=i("f2ff");function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i,n,s,o,r){try{var a=e[o](r),u=a.value}catch(m){return void i(m)}a.done?t(u):Promise.resolve(u).then(n,s)}function u(e){return function(){var t=this,i=arguments;return new Promise((function(n,s){var o=e.apply(t,i);function r(e){a(o,n,s,r,u,"next",e)}function u(e){a(o,n,s,r,u,"throw",e)}r(void 0)}))}}var m={name:"ETBexperiment_new",data:function(){return{rememberAbilityTask:this.$imageUrl.urls.rememberAbilityTask,whiteFlagNew:this.$imageUrl.urls.whiteFlagNew,testFlag:!0,timingShow:!0,timingFlag:null,timingNum:5,countDownStr:"测试马上开始！",crossShow:!1,expressionShow:!1,buttonShow:!1,timingOne:null,timingTwo:null,timingThree:null,flag:null,commonTime:0,cumulation:0,examImgUrl:"",arrList:["01","02","03","04","05","06","07","08","09","10"],randomArr:[],resultData:[],isClick:!0,timeOut:5e3}},onShow:function(){this.userId=this.$store.state.userInfo.user.id,this.testFlag=!0,this.timingShow=!0,this.timingFlag=null,this.timingNum=5,this.countDownStr="测试马上开始！",this.crossShow=!1,this.expressionShow=!1,this.buttonShow=!1,this.timingOne=null,this.timingTwo=null,this.timingThree=null,this.flag=null,this.commonTime=0,this.cumulation=0,this.examImgUrl="",this.arrList=["01","02","03","04","05","06","07","08","09","10"],this.randomArr=[],this.resultData=[],this.isClick=!0,this.timeOut=5e3},mounted:function(){""!=this.$store.state.userInfo.user.id?this.startTiming():getApp().jumpToLoginParams()},onShareAppMessage:function(e){var t={path:"/cognitiveTasksPage/ETBexperiment_new?examWidght=ETBexperiment_new&FROMTO=cognitiveTasksPage",imageUrl:"",success:function(e){e.errMsg},fail:function(){"shareAppMessage:fail cancel"==res.errMsg||res.errMsg}};if("button"==e.from){e.target.dataset;t.path="/cognitiveTasksPage/ETBexperiment_new?examWidght=ETBexperiment_new&FROMTO=cognitiveTasksPage"}return t},methods:{startTiming:function(){var e=this;this.testFlag=!1,this.timingFlag=setInterval((function(){0==e.timingNum?(e.countDownStr="开始",setTimeout((function(){e.timingShow=!1,e.timingFlag=clearInterval(e.timingFlag),e.startTest()}),1e3),e.timingFlag=clearInterval(e.timingFlag)):(e.countDownStr=e.timingNum,e.timingNum--)}),1e3)},format:function(e){return 100===e?"任务已完成":"任务进度"},startTime:function(){var e=this;this.commonTime=0,this.flag=setInterval((function(){e.commonTime++}),10)},endTime:function(){this.flag=clearInterval(this.flag)},randomList:function(){this.randomArr=[];for(var e=0;e<3;e++){var t=Math.floor(10*Math.random());if(e<10){if(-1!==this.randomArr.indexOf(this.arrList[t])){e-=1;continue}this.randomArr.push(this.arrList[t])}else this.randomArr.push(this.arrList[t])}},shuffle:function(e){return u(n.default.mark((function t(){var i,s,o;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(i=1;i<e.length;i++)s=Math.floor(Math.random()*(i+1)),o=[e[s],e[i]],e[i]=o[0],e[s]=o[1];return t.abrupt("return",e);case 2:case"end":return t.stop()}}),t)})))()},initImgList:function(e){var t=this;return u(n.default.mark((function i(){return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,t.randomList();case 2:t.randomArr.map((function(i){var n="".concat(i>="06"?"m"+i:"f"+i,"-happy-0").concat(e+1),s="".concat(i>="06"?"m"+i:"f"+i,"-fear-0").concat(e+1),r="".concat(i>="06"?"m"+i:"f"+i,"-angry-0").concat(e+1),a="".concat(i>="06"?"m"+i:"f"+i,"-disgust-0").concat(e+1),u="".concat(i>="06"?"m"+i:"f"+i,"-sad-0").concat(e+1),m="".concat(i>="06"?"m"+i:"f"+i,"-surprise-0").concat(e+1);t.resultData.push({emoType:"happy",emoAmp:e,userSelectEmoType:"",responseTime:"",correct:"",imgUrl:o.ETBexperimentImgs[n]}),t.resultData.push({emoType:"fear",emoAmp:e,userSelectEmoType:"",responseTime:"",correct:"",imgUrl:o.ETBexperimentImgs[s]}),t.resultData.push({emoType:"angry",emoAmp:e,userSelectEmoType:"",responseTime:"",correct:"",imgUrl:o.ETBexperimentImgs[r]}),t.resultData.push({emoType:"disgust",emoAmp:e,userSelectEmoType:"",responseTime:"",correct:"",imgUrl:o.ETBexperimentImgs[a]}),t.resultData.push({emoType:"sad",emoAmp:e,userSelectEmoType:"",responseTime:"",correct:"",imgUrl:o.ETBexperimentImgs[u]}),t.resultData.push({emoType:"surprise",emoAmp:e,userSelectEmoType:"",responseTime:"",correct:"",imgUrl:o.ETBexperimentImgs[m]})}));case 3:case"end":return i.stop()}}),i)})))()},imgListSerialize:function(){var e=this;return u(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.initImgList(0);case 2:return t.next=4,e.initImgList(1);case 4:return t.next=6,e.initImgList(2);case 6:return t.next=8,e.initImgList(3);case 8:return t.next=10,e.shuffle(e.resultData);case 10:e.resultData.map((function(e,t){return e.index=t})),e.changeImg(e.cumulation),e.showCross(),console.log(e.resultData,"图片数组序列222");case 14:case"end":return t.stop()}}),t)})))()},changeImg:function(e){this.examImgUrl=this.resultData[e].imgUrl},showCross:function(){var e=this;this.crossShow=!0,this.expressionShow=!1,this.buttonShow=!1,this.timingOne=setTimeout((function(){e.showImg()}),750)},showImg:function(){var e=this;this.crossShow=!1,this.expressionShow=!0,this.buttonShow=!1,this.timingTwo=setTimeout((function(){e.showBtn()}),500)},showBtn:function(){var e=this;this.startTime(),this.crossShow=!1,this.expressionShow=!1,this.buttonShow=!0,this.timingThree=setTimeout((function(){console.log("123"),e.buttonShow=!1,e.endTime(),e.resultData[e.cumulation].userSelectEmoType="NO",e.resultData[e.cumulation].responseTime="NULL",e.resultData[e.cumulation].correct="False",e.cumulation>=71?e.submitData():(e.cumulation++,e.changeImg(e.cumulation),e.showCross())}),5e3)},userClick:function(e){this.timingThree=clearTimeout(this.timingThree),this.endTime(),this.resultData[this.cumulation].userSelectEmoType=e,this.resultData[this.cumulation].responseTime=10*this.commonTime,this.resultData[this.cumulation].correct=e==this.resultData[this.cumulation].emoType?"True":"False",this.cumulation>=71?this.submitData():(this.cumulation++,this.changeImg(this.cumulation),this.showCross())},submitData:function(){var t=this,i=[],n=[],o=[],r=[],a=[],u=[],m=[],l=[],c=[],h=[],p=[],g=[],f=[],d=[],T=[],v=[],w=[],x=[],y=[],A=[],F=[],S=[],I=[],b=[],D=[];this.resultData.map((function(e,t){"True"==e.correct&&i.push(e)})),i.map((function(e){"happy"==e.emoType&&0==e.emoAmp&&n.push(e),"happy"==e.emoType&&1==e.emoAmp&&o.push(e),"happy"==e.emoType&&2==e.emoAmp&&r.push(e),"happy"==e.emoType&&3==e.emoAmp&&a.push(e),"fear"==e.emoType&&0==e.emoAmp&&u.push(e),"fear"==e.emoType&&1==e.emoAmp&&m.push(e),"fear"==e.emoType&&2==e.emoAmp&&l.push(e),"fear"==e.emoType&&3==e.emoAmp&&c.push(e),"angry"==e.emoType&&0==e.emoAmp&&h.push(e),"angry"==e.emoType&&1==e.emoAmp&&p.push(e),"angry"==e.emoType&&2==e.emoAmp&&g.push(e),"angry"==e.emoType&&3==e.emoAmp&&f.push(e),"disgust"==e.emoType&&0==e.emoAmp&&d.push(e),"disgust"==e.emoType&&1==e.emoAmp&&T.push(e),"disgust"==e.emoType&&2==e.emoAmp&&v.push(e),"disgust"==e.emoType&&3==e.emoAmp&&w.push(e),"sad"==e.emoType&&0==e.emoAmp&&x.push(e),"sad"==e.emoType&&1==e.emoAmp&&y.push(e),"sad"==e.emoType&&2==e.emoAmp&&A.push(e),"sad"==e.emoType&&3==e.emoAmp&&F.push(e),"surprise"==e.emoType&&0==e.emoAmp&&S.push(e),"surprise"==e.emoType&&1==e.emoAmp&&I.push(e),"surprise"==e.emoType&&2==e.emoAmp&&b.push(e),"surprise"==e.emoType&&3==e.emoAmp&&D.push(e)}));var k={userId:this.userId,testPlanId:this.testPlanId||"",data:this.resultData,result:{totalResult:(i.length/72*100).toFixed(2)+"%",happy:{level1:(n.length/3*100).toFixed(2)+"%",level2:(o.length/3*100).toFixed(2)+"%",level3:(r.length/3*100).toFixed(2)+"%",level4:(a.length/3*100).toFixed(2)+"%"},fear:{level1:(u.length/3*100).toFixed(2)+"%",level2:(m.length/3*100).toFixed(2)+"%",level3:(l.length/3*100).toFixed(2)+"%",level4:(c.length/3*100).toFixed(2)+"%"},angry:{level1:(h.length/3*100).toFixed(2)+"%",level2:(p.length/3*100).toFixed(2)+"%",level3:(g.length/3*100).toFixed(2)+"%",level4:(f.length/3*100).toFixed(2)+"%"},disgust:{level1:(d.length/3*100).toFixed(2)+"%",level2:(T.length/3*100).toFixed(2)+"%",level3:(v.length/3*100).toFixed(2)+"%",level4:(w.length/3*100).toFixed(2)+"%"},sad:{level1:(x.length/3*100).toFixed(2)+"%",level2:(y.length/3*100).toFixed(2)+"%",level3:(A.length/3*100).toFixed(2)+"%",level4:(F.length/3*100).toFixed(2)+"%"},surprise:{level1:(S.length/3*100).toFixed(2)+"%",level2:(I.length/3*100).toFixed(2)+"%",level3:(b.length/3*100).toFixed(2)+"%",level4:(D.length/3*100).toFixed(2)+"%"}}},E=this.$CryptoJS.AesEncrypt(JSON.stringify(k));this.isClick&&(this.isClick=!1,this.$request.post({url:s.cognizeETB01,data:{data:E}}).then((function(i){200==(null===i||void 0===i?void 0:i.code)?(console.log("--response测试 结果------\x3e",i),t.goTestResult(i.data)):e.showToast({title:null===i||void 0===i?void 0:i.msg})}),(function(t){e.showToast({title:t.msg})}))),e.showToast({title:"测试完成"}),setTimeout((function(){t.isClick=!0}),this.timeOut)},goTestResult:function(t){return u(n.default.mark((function i(){var s;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,getApp().getVersionId(t);case 2:s=getApp().globalData.isTrue,console.log("旧====>",s),setTimeout((function(){s?e.navigateTo({url:"/cognitiveTasksTestResult/testResultNew?id="+t+"&messageShare=1"}):e.navigateTo({url:"/cognitiveTasksTestResult/testResult?id="+t+"&messageShare=1&flag="+getApp().globalData.flag})}),1e3);case 5:case"end":return i.stop()}}),i)})))()},startTest:function(){this.imgListSerialize()}},destroyed:function(){clearInterval(this.timingFlag),clearInterval(this.flag),clearTimeout(this.timingOne),clearTimeout(this.timingTwo),clearTimeout(this.timingThree)}};t.default=m}).call(this,i("543d")["default"])}},[["818d","common/runtime","common/vendor","cognitiveTasksPage/common/vendor"]]]);