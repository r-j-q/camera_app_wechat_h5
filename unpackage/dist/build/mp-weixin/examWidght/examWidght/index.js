(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["examWidght/examWidght/index"],{"0dd2":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var r={uSticky:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-sticky/u-sticky")]).then(n.bind(null,"b56e"))}},i=function(){var e=this,t=e.$createElement;e._self._c},o=[]},"33d1":function(e,t,n){},"4f9d":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("a34a")),i=n("26cb"),o=n("6df0");function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)}))}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f,p=function(){n.e("examWidght/components/Li-ExamWidght/Li-ExamWidght").then(function(){return resolve(n("f5ff"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("examWidght/components/lineProgress/index").then(function(){return resolve(n("c08e"))}.bind(null,n)).catch(n.oe)},h={components:{examWidght:p,LineProgress:g},computed:l({},(0,i.mapGetters)(["userInfo"])),data:function(){return{scale_infos:[{questionType:"",answer:""}],scale_index:0,scale_all:0,scale_result:[],scale_checkItems:[],scale_percent:0,checkedCities:[],lastText:"上一题",nextText:"下一题",finishText:"完成",radio:"",scale_result_all:[],listIndex:0,showIndexText:!1,numBoxShow:!1,questionType:0,flag:"",price:"",resultId:"",timer:"",QuestionListAll:[],QuestionList:{answer:""},currentIndex:0,total:0,orderNo:"",reportVersion:"",handleNumber:1,name:""}},destroyed:function(){f.handleNumber=1},onLoad:function(t){var n,r;(f=this,console.log("options2",t),t.flag)&&(f.flag=t.flag,f.id=t.id,f.name=t.name,f.reportVersion=t.reportVersion,e.setNavigationBarTitle({title:t.name}),""!=(null===(n=f.userInfo)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.id)?f.getScaleInfoAnswerList(t.flag):getApp().jumpToLoginParams(f.flag,f.id,f.name,f.reportVersion))},onShareAppMessage:function(e){var t=this,n={path:"/examWidght/examWidght/index?flag="+t.flag+"&id="+t.id+"&name="+t.name+"&reportVersion="+t.reportVersion,imageUrl:"",success:function(e){e.errMsg},fail:function(){"shareAppMessage:fail cancel"==res.errMsg||res.errMsg}};return n},onHide:function(){clearInterval(this.timer)},methods:{catchTouchMove:function(e){return!1},goPrevAnswer:function(){if(f.currentIndex<1)e.showToast({icon:"none",title:"已经是第一题"});else{var t=f.currentIndex-1;f.currentIndex=t;var n=Object.assign({},f.QuestionListAll[t]);f.QuestionList=n}},goNextAnswer:function(){var t=f.currentIndex+1;if(t>f.QuestionListAll.length-1)return f.currentIndex=t-1,void e.showToast({icon:"none",title:"已经是最后一题"});if(""!=f.QuestionListAll[f.currentIndex].fldAnswer){f.currentIndex=t;var n=Object.assign({},f.QuestionListAll[t]);f.QuestionList=n}else e.showToast({icon:"none",title:"请先答题"})},onItemAnswer:function(e){f.QuestionListAll[f.currentIndex].checkItems=e.fldOptionText,f.QuestionListAll[f.currentIndex].fldAnswer=e.fldOptionText;var t=Object.assign({},f.QuestionListAll[f.currentIndex]);f.QuestionList=t},onListItemAnswer:function(e){if(f.currentIndex>=f.total-1){f.QuestionListAll[f.currentIndex].checkItems=e.fldOptionText,f.QuestionListAll[f.currentIndex].fldAnswer=e.fldOptionText;var t=Object.assign({},f.QuestionListAll[f.currentIndex]);f.QuestionList=t}else{f.currentIndex=f.currentIndex+1,f.QuestionListAll[f.currentIndex-1].checkItems=e.fldOptionText,f.QuestionListAll[f.currentIndex-1].fldAnswer=e.fldOptionText;var n=Object.assign({},f.QuestionListAll[f.currentIndex]);f.QuestionList=n}},getQueryOrder:function(t){f.$request.get({url:o.queryOrder+"/"+t,loadingTip:"加载中...",data:{}}).then((function(t){var n=JSON.parse(t.data.body);"200"==t.code?"SUCCESS"==n.trade_state?(e.navigateTo({url:"/scaleTestResults/testResults/index?resultId="+f.resultId+"&messageShare=1"}),clearInterval(f.timer),e.showToast({title:"支付成功"})):"CLOSED"==n.trade_state||clearInterval(f.timer):e.showToast({title:"支付失败"})}))},payWchat:function(t,n,r,i,o,a,s){e.requestPayment({provider:t,timeStamp:n,nonceStr:r,package:i,signType:o,paySign:a,success:function(e){f.timer=setInterval((function(){f.getQueryOrder(s)}),1e3)},fail:function(t){e.navigateTo({url:"/scalePage/testRecord/index"}),e.showToast({icon:"none",title:"支付失败"})}})},getH5Pay:function(e){var t=f.$CryptoJS.AesEncrypt(JSON.stringify(e));f.$request.post({url:"".concat(o.h5Pay),loadingTip:"加载中...",data:{data:t}}).then((function(e){var t="".concat(e.data.codeUrl,"&redirect_url=").concat(url,"/h5/index.html#/scalePage/paymentStatus/index?resultId=").concat(f.resultId,"&orderNo=").concat(f.orderNo);f.navigationF(t)}))},navigationF:function(e){var t=navigator.userAgent,n=t.indexOf("Android")>-1||t.indexOf("Adr")>-1;t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);n?window.open(e):window.location.href=e},getNative:function(e){var t=f.$CryptoJS.AesEncrypt(JSON.stringify(e));f.$request.post({url:"".concat(o.native),loadingTip:"加载中...",data:{data:t}}).then((function(e){f.orderNo=e.data.orderNo;var t=JSON.parse(e.data.codeUrl);f.payWchat(t.provider,t.timeStamp,t.nonceStr,t.package,t.signType,t.paySign,e.data.orderNo)}))},getQueryPromotionBySubjectId:function(t){return c(r.default.mark((function n(){var i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=o.queryPromotionBySubjectId+"/"+t,n.next=3,f.$request.get({url:i,loadingTip:"加载中...",data:{}}).then((function(n){if(f.price=n.data.price,0==n.data.price)console.log("=获取支付金额接口数据==1==》",n),e.navigateTo({url:"/scaleTestResults/testResults/index?resultId="+f.resultId+"&messageShare=1"});else{var r,i,o,a;console.log("=获取支付金额接口数据=2===》",n);var s={productId:t,userId:null===(r=f.userInfo)||void 0===r||null===(i=r.user)||void 0===i?void 0:i.id,resultId:f.resultId,description:n.data.name,total:n.data.price,openId:null===(o=f.userInfo)||void 0===o||null===(a=o.openId)||void 0===a?void 0:a.openId};f.getNative(s)}}));case 3:case"end":return n.stop()}}),n)})))()},getScaleInfoAnswerList:function(e){f.$request.get({url:"".concat(o.getScaleInfo,"/").concat(e),loadingTip:"加载中...",data:{}}).then((function(e){if(200==e.code&&e.data.length>0){f.scale_infos=e.data,f.scale_all=f.scale_infos.length,f.scale_checkItems=f.scale_infos[f.scale_index].checkItems.split("；"),f.scale_percent=parseInt((f.scale_index+1)/f.scale_all),f.scale_percent=100*(f.scale_index+1)/f.scale_all;f.scale_infos.forEach((function(e,t){e.questionID=e.id,e.fldAnswer="";var n=[];if(e.checkItems){var r=e.checkItems.split("；");r.forEach((function(e,t){n.push({fldOptionText:e,fldOptionIndex:t+1})})),e.QuestionOptionList=n}})),f.total=f.scale_infos.length,f.QuestionListAll=f.scale_infos,f.QuestionList=f.scale_infos[f.currentIndex]}}))},subMitList:function(t){var n,r,i=f.QuestionListAll;if(""!=f.QuestionListAll[f.currentIndex].fldAnswer){i.forEach((function(e){delete e.QuestionOptionList,delete e.fldAnswer,delete e.questionID}));var a={testPlanId:"",scale_result:i,userId:null===(n=f.userInfo)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.id};console.log("提交的参数",a);var s=f.$CryptoJS.AesEncrypt(JSON.stringify(a));e.showLoading({title:"测试结果生成中"}),f.$request.post({url:"".concat(o.getResult,"/").concat(f.flag),loadingTip:"加载中...",data:{data:s}}).then((function(t){f.resultId=t.data,e.hideLoading(),f.getQueryPromotionBySubjectId(f.id)}))}else e.showToast({icon:"none",title:"请先答题"})},getUserIP:function(e){var t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,n=new t({iceServers:[]}),r=function(){},i={},o=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g,a=function(t){i[t]||e(t),i[t]=!0};n.createDataChannel(""),n.createOffer().then((function(e){e.sdp.split("\n").forEach((function(e){e.indexOf("candidate")<0||e.match(o).forEach(a)})),n.setLocalDescription(e,r,r)})).catch((function(e){})),n.onicecandidate=function(e){e&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.match(o)&&e.candidate.candidate.match(o).forEach(a)}}}};t.default=h}).call(this,n("543d")["default"])},a5be:function(e,t,n){"use strict";n.r(t);var r=n("4f9d"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},c3c2:function(e,t,n){"use strict";n.r(t);var r=n("0dd2"),i=n("a5be");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("f0ff");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"99320e1a",null,!1,r["a"],a);t["default"]=c.exports},dd10:function(e,t,n){"use strict";(function(e){n("9263");r(n("66fd"));var t=r(n("c3c2"));function r(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},f0ff:function(e,t,n){"use strict";var r=n("33d1"),i=n.n(r);i.a}},[["dd10","common/runtime","common/vendor"]]]);